# Shell Emulator - Эмулятор командной оболочки

## 1. Общее описание

**ShellEmulator** — это консольное Java-приложение, моделирующее работу UNIX-подобной командной оболочки.
Программа реализует методы из реальной ОС, такие, как:
- *cd* - перемещение по папкам виртуальной файловой системы;
- *ls* - просмотр вложенных файлов и папок;
- *head* - вывод первых строк файла;
- *du* - подсчет размера папки или файла;
- *uname* - вывод информации о текущем состоянии системы;
- *su* - смена пользователя;
- *chmod* - изменение прав доступа к файлам;

***

## 2. Описание всех функций и настроек

###  Классы, использованные в программе

| Класс             | Назначение                                                         |
|:------------------|:-------------------------------------------------------------------|
| **ShellEmulator** | Главный класс программы, обрабатывает команды и управляет сессией. |
| **VDirectory**    | Описывает виртуальный каталог (содержит подкаталоги и файлы).      |
| **VFile**         | Описывает виртуальный файл (имя, содержимое, владелец, права).     |

### Методы

| Метод                    | Назначение                                                                                                                             |
|:-------------------------|:---------------------------------------------------------------------------------------------------------------------------------------|
| **main**                 | Точка входа программы. Создаёт экземпляр `ShellEmulator` и вызывает метод `start`.                                                     |
| **start**                | Основной метод инициализации: определяет имя хоста, загружает VFS и стартовый скрипт, запускает интерактивный режим.                   |
| **askUserForPaths**      | Запрашивает у пользователя путь к файлу виртуальной файловой системы и путь к стартовому скрипту при запуске программы без аргументов. |
| **parseArguments**       | Обрабатывает аргументы командной строки и присваивает пути к VFS и скрипту.                                                            |
| **printDebugInfo**       | Выводит на экран текущую конфигурацию эмулятора (пользователь, хост, пути к файлам).                                                   |
| **loadVFS**              | Загружает виртуальную файловую систему из CSV-файла: создаёт каталоги и файлы, декодируя содержимое Base64.                            |
| **createDirectory**      | Рекурсивно создаёт структуру каталогов в памяти на основе пути.                                                                        |
| **createFile**           | Создаёт новый файл в заданном каталоге и сохраняет его содержимое.                                                                     |
| **navigateToDirectory**  | Возвращает объект каталога по указанному пути (абсолютному или относительному).                                                        |
| **runInteractiveMode**   | Запускает интерактивный режим ввода команд с консоли.                                                                                  |
| **processCommand**       | Разбирает введённую строку, определяет команду и вызывает соответствующий метод обработки.                                             |
| **parseInput**           | Разделяет строку пользовательского ввода на отдельные аргументы (по пробелам).                                                         |
| **commandLs**            | Реализует команду `ls` — вывод содержимого текущего каталога; с флагом `-l` показывает владельца и права доступа.                      |
| **formatPermissions**    | Преобразует массив числовых прав (например, `{7,4,4}`) в строку формата `rwxr--r--`.                                                   |
| **formPermission**       | Возвращает строку из трёх символов (`rwx`, `rw-`, `r--` и т. д.) для одной категории прав.                                             |
| **commandCd**            | Реализует команду `cd` — переход между каталогами.                                                                                     |
| **commandHead**          | Реализует команду `head` — выводит первые *n* строк указанного файла; проверяет права доступа на чтение.                               |
| **commandDu**            | Реализует команду `du` — вычисляет размер файла или каталога (в байтах).                                                               |
| **getDirSize**           | Подсчитывает суммарный размер всех файлов в каталоге и его подкаталогах.                                                               |
| **commandUname**         | Реализует команду `uname` — выводит информацию об эмуляторе, пользователе, ОС и версии Java.                                           |
| **commandSu**            | Реализует команду `su` — смена текущего пользователя.                                                                                  |
| **commandChmod**         | Реализует команду `chmod` — изменяет права доступа файла.                                                                              |
| **getHostName**          | Определяет имя хоста (компьютера) текущей системы.                                                                                     |
| **executeStartupScript** | Считывает и выполняет команды из указанного текстового файла, имитируя их ввод пользователем.                                          |

## 3. Команды для сборки проекта и запуска тестов

Компиляция:
`javac Konfig/ShellEmulator.java`

Запуск без аргументов (ручной ввод путей):
`java Konfig.ShellEmulator`

Запуск с аргументами:
`java Konfig.ShellEmulator Konfig/vfc.csv Konfig/startup.txt`

## 4. Примеры использования

### Пример vfc файла:
``` declarative
path,type,content
/,dir,
/home,dir,
/home/roman,dir,
/home/roman/info.txt,file,VGhpcyBpcyBSb21hbidzIGZpbGUu
/home/roman/secret.txt,file,U2VjcmV0IGRhdGE=
/home/user2,dir,
/home/user2/notes.txt,file,SGVsbG8gUm9tYQ==
/docs,dir,
/docs/manual.txt,file,UmVhZCBtYW51YWwu
```

### Пример стартового скрипта:
``` declarative
ls
cd home
cd roman
ls -l
head info.txt 2
chmod secret.txt 700
su user2
head /home/roman/secret.txt
du /home
uname
su Roman
exit
```

### Вывод после выполнения стартового скрипта:
``` declarative
Конфигурация эмулятора
Пользователь: Roman
Имя хоста: DESKTOP-2ROJP6R
Путь к VFS: Konfig\vfc
Путь к стартовому скрипту: Konfig\scripts


VFS успешно загружена!

Выполнение стартового скрипта: Konfig\scripts
Roman@DESKTOP-2ROJP6R:/$ ls
Содержимое каталога /:
[dir]  home
[dir]  docs

Roman@DESKTOP-2ROJP6R:/$ cd home

Roman@DESKTOP-2ROJP6R:/home$ cd roman

Roman@DESKTOP-2ROJP6R:/home/roman$ ls -l
Содержимое каталога /home/roman:
[file] info.txt owner: Roman permissions: rwxr--r--
[file] secret.txt owner: Roman permissions: rwxr--r--

Roman@DESKTOP-2ROJP6R:/home/roman$ head info.txt 2
This is Roman's file.

Roman@DESKTOP-2ROJP6R:/home/roman$ chmod secret.txt 700

Roman@DESKTOP-2ROJP6R:/home/roman$ su user2

user2@DESKTOP-2ROJP6R:/home/roman$ head home/roman/secret.txt
Ошибка: нет прав на чтение файла.

user2@DESKTOP-2ROJP6R:/home/roman$ cd /

user2@DESKTOP-2ROJP6R:/$ du home
/home: 42 байт

user2@DESKTOP-2ROJP6R:/$ uname
Эмулятор: ShellEmulator
Пользователь: user2
Роль пользователя: other
Хост: DESKTOP-2ROJP6R
ОС: Windows 11
Java: 24.0.2
Дата: 10.10.2025 14:29:30

user2@DESKTOP-2ROJP6R:/$ su Roman

Завершено выполнение скрипта

Интерактивный режим. Введите 'exit' для выхода.

Roman@DESKTOP-2ROJP6R:/$ exit
Выход из эмулятора...
```